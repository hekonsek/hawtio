<div ng-controller="Camel.SendMessageController">

  <tabset>
    <tab heading="Compose">
      <div class="container-fluid">
        <div class="row" ng-show="noCredentials">
          <div class="col-md-12 alert alert-warning">
            No credentials set for endpoint! Please set your username and password in the
            <a href="" ng-click="openPrefs()">Preferences</a> page
          </div>
        </div>
        <div class="row">
          <div class="pull-right">
            <form class="form-inline">
              <button class="btn btn-default" ng-click="addHeader()" title="Add a new message header">
                <i class="icon-plus"></i> Header
              </button>
              <button type="submit" class="btn btn-primary" ng-click="sendMessage()">Send message</button>
            </form>
          </div>
        </div>
        <form class="form-inline bottom-margin" ng-submit="addHeader()">
          <div class="row" ng-repeat="header in headers">
            <div class="col-md-4">
              <input type="text" style="width: 100%" class="form-control headerName" ng-model="header.name"
                  typeahead="completion for completion in defaultHeaderNames() | filter:$viewValue"
                  typeahead-editable='true'
                  placeholder="Header name" />
            </div>
            <div class="col-md-6">
              <input type="text" style="width: 100%" ng-model="header.value" class="form-control" placeholder="Value of the message header" />
            </div>
            <div class="col-md-2">
              <button type="submit" class="btn btn-primary" title="Add a new message header">
                <i class="icon-plus"></i>
              </button>
              <button type="button" ng-click="removeHeader(header)" class="btn btn-default" title="Removes this message header">
                <i class="icon-remove"></i>
              </button>
            </div>
          </div>
        </form>
        <div class="row">
          <form class="form-inline">
            <div class="controls">
              <label class="control-label" for="sourceFormat" title="The text format to use for the message payload">Payload format: </label>
              <select ng-model="codeMirrorOptions.mode.name" id="sourceFormat" class="form-control">
                <option value="javascript">JSON</option>
                <option value="text" selected>Plain text</option>
                <option value="properties">Properties</option>
                <option value="xml">XML</option>
              </select>
              <button class="btn btn-default" ng-click="autoFormat()" title="Automatically pretty prints the message so its easier to read">Auto format</button>
            </div>
          </form>
        </div>
        <div class="row">
          <textarea ui-codemirror="codeMirrorOptions" ng-model="message"></textarea>
        </div>
      </div>
    </tab>

    <tab heading="Choose" ng-hide="!showChoose">
      <div class="container-fluid">
        <div class="row" ng-show="noCredentials">
          <div class="col-md-12 alert alert-warning">
            No credentials set for endpoint! Please set your username and password in the
            <a href="" ng-click="openPrefs()">Preferences</a> page
          </div>
        </div>
        <div class="row">
          <button type="submit" ng-disabled="!fileSelection().length" class="btn btn-primary pull-right" ng-click="sendSelectedFiles()">
            <ng-pluralize count="fileSelection().length" when="{'0': 'No files selected', '1': 'Send the file','other': 'Send {} files'}"></ng-pluralize>
          </button>
        </div>

        <p>Choose which files to send from the profile configuration:</p>

        <div class="form-group section-filter">
          <input class="input-sm form-control search-query" type="text" ng-model="searchText" placeholder="Filter...">
          <i class="icon-remove clickable" title="Clear filter" ng-click="searchText = ''"></i>
        </div>

        <ul>
          <li ng-repeat="fileName in profileFileNames | filter:searchText">
            <input type="checkbox" ng-model="selectedFiles[fileName]"> {{fileName}}
          </li>
        </ul>
      </div>
    </tab>
  </tabset>

</div>
